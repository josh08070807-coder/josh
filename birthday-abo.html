<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday Â· å°é˜¿æ³¢ ğŸ‚</title>
  <meta name="description" content="å¯†ç¢¼è§£é– Â· æŸ”ç²‰ç”Ÿæ—¥å¡ Â· å¯ä¸‹è¼‰" />
  <!-- å­—é«”ï¼šæ‰‹å¯«é¢¨ + æ€æºé»‘é«”ï¼ˆå‚™æ´ï¼‰ -->
  <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --pink-50:#fff7fa; --pink-100:#ffe9f0; --pink-200:#ffd6e3;
      --ink:#2b2b2b; --sub:#6b7280; --brand:#ff6b9a;
      --card:#ffffff; --shadow:0 18px 40px rgba(0,0,0,.10); --radius:24px;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; color:var(--ink);
      font-family:"Noto Sans TC", system-ui, -apple-system, "PingFang TC", "Microsoft JhengHei", sans-serif;
      background:
        radial-gradient(1200px 600px at 10% 0%, var(--pink-100), transparent),
        radial-gradient(1000px 600px at 90% 20%, var(--pink-200), transparent),
        linear-gradient(180deg, var(--pink-50), #fff);
      overflow-x:hidden;
    }
    /* â€”â€” å¯†ç¢¼é  â€”â€” */
    #gate{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding:24px; background:linear-gradient(180deg,var(--pink-50),#fff); z-index:20}
    .lock{
      width:min(520px,92vw); background:var(--card); border-radius:var(--radius);
      box-shadow:var(--shadow); padding:28px 22px; text-align:center; position:relative; overflow:hidden
    }
    .lock::before{content:""; position:absolute; inset:-40% -20%;
      background:radial-gradient(closest-side, rgba(255,203,221,.5), transparent 60%);
      filter:blur(30px); z-index:0}
    .lock h1{position:relative; z-index:1; margin:2px 0 10px; font-size:clamp(22px,4vw,28px)}
    .hint{position:relative; z-index:1; color:var(--sub); margin-bottom:16px}
    .pin{position:relative; z-index:1; display:flex; gap:10px; justify-content:center; margin:16px 0}
    .pin input{width:60px; height:60px; text-align:center; font-size:28px; border-radius:14px; border:1px solid #f2c9d7; outline:none; background:#fffafb}
    .btn{position:relative; z-index:1; appearance:none; border:none; border-radius:14px; padding:12px 18px; font-weight:800; background:var(--brand); color:#fff; box-shadow:var(--shadow); cursor:pointer}
    .err{position:relative; z-index:1; color:#d33; min-height:20px; margin-top:10px}

    /* â€”â€” å…§å®¹é  â€”â€” */
    #app{opacity:0; pointer-events:none; transition:opacity .8s ease}
    #app.ready{opacity:1; pointer-events:auto}
    header{min-height:88vh; display:grid; place-items:center; padding:64px 20px; position:relative; overflow:hidden}

    /* æŸ”ç„¦èƒŒæ™¯è¼ªæ’­ */
    .bg{position:absolute; inset:0; z-index:0; filter: blur(6px) saturate(110%); opacity:.45}
    .bg img{position:absolute; width:100%; height:100%; object-fit:cover; transition:opacity 1s ease}
    .bg img:not(.show){opacity:0}

    .hero{position:relative; z-index:2; text-align:center; max-width:960px}
    .badge{display:inline-flex; gap:8px; align-items:center; padding:8px 14px; border-radius:999px; background:#ffe6ef; color:#b31642; font-weight:700; font-size:14px}
    h1{margin:14px 0 8px; font-size: clamp(30px, 6vw, 56px); font-weight:800}
    .title-hand{font-family:"Ma Shan Zheng","Noto Sans TC", cursive; font-weight:400; letter-spacing:.5px}
    .lead{color:var(--sub); font-size:clamp(15px,2.6vw,18px); margin:0 0 18px}
    .tap{display:inline-block; margin-top:10px; padding:10px 16px; border-radius:999px; background:#fff; box-shadow:var(--shadow); font-weight:700; cursor:pointer}

    section{padding: 36px 20px}
    .wrap{max-width: 1000px; margin:auto}
    .card{position:relative; background:rgba(255,255,255,.86); backdrop-filter: blur(6px); border:1px solid #ffd7e5; border-radius:var(--radius); box-shadow:var(--shadow); padding:26px}
    .paper{
      font-family:"Ma Shan Zheng","Noto Sans TC", cursive; font-size:22px; line-height:1.9; color:#4b5563; white-space:pre-wrap;
      background: repeating-linear-gradient(180deg, rgba(255,240,246,.8), rgba(255,240,246,.8) 34px, rgba(255,220,236,.6) 35px);
      padding:22px 18px; border-radius:18px; border:1px dashed #ffc1d4
    }
    .typing{border-right:2px solid var(--brand)}

    /* æµ®å‹•æ„›å¿ƒ */
    .heart{position:fixed; bottom:-20px; font-size:22px; color:#ff7b9c; opacity:.9; animation: floatUp 6.5s linear forwards; z-index:1}
    @keyframes floatUp{0%{transform: translateY(0) translateX(0) scale(.9); opacity:.9} 70%{opacity:.9} 100%{transform: translateY(-110vh) translateX(var(--dx)) scale(1.15); opacity:0}}

    /* éŸ³æ¨‚èˆ‡ä¸‹è¼‰æ§åˆ¶ */
    .controls{position: fixed; right:16px; bottom:16px; display:flex; gap:10px; z-index:5}
    .ctrl{border:none; background:#fff; color:#111; padding:10px 14px; border-radius:999px; box-shadow:var(--shadow); font-weight:800; cursor:pointer}

    footer{padding:40px 20px 80px; text-align:center; color:#6b7280}
  </style>
</head>
<body>
  <!-- ğŸ”’ å¯†ç¢¼é  -->
  <div id="gate" role="dialog" aria-modal="true">
    <div class="lock">
      <h1>ğŸ”’ è«‹è¼¸å…¥é€šé—œå¯†ç¢¼</h1>
      <div class="hint">æç¤ºï¼šå¦³çš„ç”Ÿæ—¥ï¼ˆå››ä½æ•¸ï¼‰ğŸ’•</div>
      <div class="pin" id="pin">
        <input inputmode="numeric" maxlength="1" aria-label="ç¬¬ä¸€ç¢¼">
        <input inputmode="numeric" maxlength="1" aria-label="ç¬¬äºŒç¢¼">
        <input inputmode="numeric" maxlength="1" aria-label="ç¬¬ä¸‰ç¢¼">
        <input inputmode="numeric" maxlength="1" aria-label="ç¬¬å››ç¢¼">
      </div>
      <button class="btn" id="unlock">è§£é–</button>
      <div class="err" id="err"></div>
    </div>
  </div>

  <!-- ğŸ‚ å…§å®¹é  -->
  <div id="app" aria-live="polite">
    <header>
      <!-- æŸ”ç„¦èƒŒæ™¯è¼ªæ’­ï¼ˆä½ çš„ä¸‰å¼µç…§ç‰‡ï¼‰ -->
      <div class="bg" aria-hidden="true">
        <img id="bg1" class="show" src="https://drive.google.com/uc?export=view&id=10F7c4lYwIqlfw1aoM_0KAwoyBjUJbQEy" alt="bg1"/>
        <img id="bg2" src="https://drive.google.com/uc?export=view&id=1PIoRM4NDHYuXy9gx8lsWp5873Z6FzMba" alt="bg2"/>
        <img id="bg3" src="https://drive.google.com/uc?export=view&id=12_GUZMwTt6N1Nf15Hlxlm0R6E3e5GqPJ" alt="bg3"/>
      </div>
      <div class="hero">
        <span class="badge">ğŸ‰ Happy 21st</span>
        <h1 class="title-hand">å°é˜¿æ³¢ï¼Œç¥å¦³21æ­²ç”Ÿæ—¥å¿«æ¨‚</h1>
        <p class="lead">é€™æ˜¯ä¸€ä»½åªå±¬æ–¼å¦³çš„æŸ”ç²‰å°å®‡å®™ ğŸ’</p>
        <button id="reveal" class="tap">ğŸ‘‰ é»æˆ‘çœ‹çœ‹</button>
      </div>
    </header>

    <section>
      <div class="wrap">
        <div id="card" class="card">
          <div id="letter" class="paper typing" style="min-height: 220px"></div>
        </div>
      </div>
    </section>

    <footer>
      <div>Made with â¤ by å–¬å…’æ³¢</div>
      <div style="font-size:12px; color:#9aa1aa">å¦‚æœæœ‰é‡ä¾†ï¼Œæˆ‘é‚„æ˜¯æœƒé¸å¦³ã€‚</div>
    </footer>

    <!-- æ§åˆ¶ï¼šéŸ³æ¨‚æ’­æ”¾ / ä¸‹è¼‰å¡ç‰‡ -->
    <div class="controls">
      <button class="ctrl" id="btnAudio">ğŸµ æ’­æ”¾</button>
      <button class="ctrl" id="btnSave">ğŸ“¥ ä¸‹è¼‰å¡ç‰‡</button>
    </div>
  </div>

  <!-- éš±è—çš„ YouTube æ’­æ”¾å™¨ï¼ˆç™»å…¥å¾Œè‡ªå‹•æ’­æ”¾ï¼‰ -->
  <iframe id="yt" width="0" height="0" src="https://www.youtube.com/embed/N5qWjQ9j6l0?enablejsapi=1" title="YouTube player" frameborder="0" allow="autoplay"></iframe>

  <!-- ä¸‹è¼‰å¡ç‰‡ï¼šhtml2canvas CDN -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- YouTube API -->
  <script>const tag=document.createElement('script');tag.src='https://www.youtube.com/iframe_api';document.body.appendChild(tag);</script>

  <script>
    // ====== åŸºæœ¬å…ƒç´  ======
    const gate = document.getElementById('gate');
    const inputs = [...document.querySelectorAll('#pin input')];
    const unlockBtn = document.getElementById('unlock');
    const err = document.getElementById('err');
    const app = document.getElementById('app');
    const revealBtn = document.getElementById('reveal');
    const letterEl = document.getElementById('letter');
    const btnAudio = document.getElementById('btnAudio');
    const btnSave = document.getElementById('btnSave');

    // ä½ çš„åŸæ–‡ï¼ˆä¿æŒä¸ä¿®æ”¹ï¼‰
    const cardText = `å°é˜¿æ³¢ ç¥å¦³21æ­²ç”Ÿæ—¥å¿«æ¨‚\né€™æ˜¯æˆ‘å€‘ä¸€èµ·éçš„ç¬¬ä¸‰å€‹ç”Ÿæ—¥ğŸ‚\næˆ‘æ˜¯çœŸçš„å¾ˆå–œæ­¡å¦³çš„å•Š\nè¬è¬å¦³é€™æ®µæ™‚é–“æ™‚é–“çš„åŒ…å®¹è·Ÿä»˜å‡º\nè·Ÿå¦³åœ¨ä¸€èµ·ä¹‹å¾Œæˆ‘å€‘å…©å€‹çœŸçš„éƒ½è®Šå²å®³äº†ä¸å°‘\nå°¤å…¶æ˜¯æˆ‘çš„å°æ³¢ ä»€éº¼éƒ½è®Šäº†å¥½å¤š è®Šå¾—æ›´å²å®³äº† ä¹Ÿæ›´åƒå¤§äººäº† ä¹Ÿè®Šçš„æ›´æ¼‚äº®äº† åªæœ‰æˆ‘é€™å€‹å¤§èƒ–æ³¢è®Šå¾—å¥½é†œå•Š åˆèƒ–åˆé†œçš„ ä½†é‚„æ˜¯è¬è¬å¦³å°æˆ‘çš„ä¸é›¢ä¸æ£„ \næ¥ä¸‹ä¾†æˆ‘å€‘å°±è¦å‡ºç¤¾æœƒäº† å¸Œæœ›æœªä¾†çš„é¢¨é¢¨é›¨é›¨ä¸è¦é‚£éº¼å¤§ è¦ä¸ç„¶æœƒè¢«å¹èµ°çš„ å¸Œæœ›æˆ‘å€‘éƒ½å¯ä»¥ç¹¼çºŒåŠ æ²¹åŠªåŠ› ç‚ºè‡ªå·±çš„æœªä¾†èªçœŸçš„ç”Ÿæ´»\nç¥æˆ‘é˜¿æ³¢ç”Ÿæ—¥å¿«æ¨‚ 21æ­²æ˜¯å¾ˆè€çš„æ³¢äº† èº«é«”è¦å¥åº· è¸å°‘æŠ½ä¸€é» å°‘ç†¬å¤œ å¤šé‹å‹• ç„¶å¾Œå¹³å¹³å®‰å®‰\n\nå¦³çš„å¤§èƒ–å–¬å…’æ³¢2025.10.25`;

    // ====== å¯†ç¢¼è¼¸å…¥ UX ======
    inputs[0].focus();
    inputs.forEach((inp, idx)=>{
      inp.addEventListener('input', ()=>{
        inp.value = inp.value.replace(/\\D/g,'');
        if(inp.value && idx<3) inputs[idx+1].focus();
      });
      inp.addEventListener('keydown', e=>{
        if(e.key==='Backspace' && !inp.value && idx>0){ inputs[idx-1].focus(); }
      })
    });

    let player, isPlaying=false;
    function onYouTubeIframeAPIReady(){ player = new YT.Player('yt', {events:{}}); }
    function tryPlay(){ if(player && player.playVideo){ player.playVideo(); isPlaying=true; btnAudio.textContent='â¸ æš«åœ'; }}
    function pause(){ if(player && player.pauseVideo){ player.pauseVideo(); isPlaying=false; btnAudio.textContent='ğŸµ æ’­æ”¾'; }}

    // æˆåŠŸè§£é–ï¼šé—œé–€ â†’ é¡¯ç¤ºå…§å®¹ â†’ è‡ªå‹•æ’­æ”¾
    unlockBtn.addEventListener('click', ()=>{
      const pin = inputs.map(i=>i.value).join('');
      if(pin==='1025'){
        err.textContent=''; gate.style.display='none'; app.classList.add('ready');
        tryPlay(); spawnBurst(18);
      }else{
        err.textContent='å¯†ç¢¼éŒ¯èª¤ ğŸ˜³ å†è©¦ä¸€æ¬¡ï¼ˆæç¤ºï¼šå¦³çš„ç”Ÿæ—¥ï¼‰';
        inputs.forEach(i=>i.value=''); inputs[0].focus();
      }
    });

    // ====== èƒŒæ™¯è¼ªæ’­ ======
    const bgs = [document.getElementById('bg1'), document.getElementById('bg2'), document.getElementById('bg3')];
    let bi=0; setInterval(()=>{ bgs.forEach((img,idx)=> img.classList.toggle('show', idx===bi)); bi=(bi+1)%bgs.length; }, 4500);

    // ====== é»æ“Šå¾Œæ‰é€å­—é¡¯ç¤º ======
    let revealed=false;
    revealBtn.addEventListener('click', ()=>{
      if(revealed) return; revealed=true;
      revealBtn.style.display='none';
      typeText(cardText, letterEl, 26);
      setTimeout(()=>spawnBurst(28), 300);
    });

    function typeText(text, el, speed){
      el.classList.add('typing');
      let i=0; const timer = setInterval(()=>{
        el.textContent = text.slice(0, i++);
        if(i>text.length){ clearInterval(timer); el.classList.remove('typing'); }
      }, speed);
    }

    // ====== æ¼‚æµ®æ„›å¿ƒ ======
    function spawnHeart(){
      const h=document.createElement('div'); h.className='heart';
      h.textContent=['ğŸ’—','ğŸ’–','ğŸ’•','ğŸ’'][Math.floor(Math.random()*4)];
      h.style.left=Math.random()*100+'vw';
      h.style.setProperty('--dx', (Math.random()*60-30)+'px');
      h.style.animationDuration=(4+Math.random()*3)+'s';
      document.body.appendChild(h); setTimeout(()=>h.remove(),7000);
    }
    function spawnBurst(n){ for(let i=0;i<n;i++) setTimeout(spawnHeart, i*100); }
    setInterval(()=> Math.random()<0.25 && spawnHeart(), 1600);

    // ====== æ§åˆ¶ï¼šéŸ³æ¨‚ã€ä¸‹è¼‰ ======
    btnAudio.addEventListener('click', ()=>{ isPlaying ? pause() : tryPlay(); });

    btnSave.addEventListener('click', async()=>{
      const node = document.getElementById('card');
      const canvas = await html2canvas(node, {backgroundColor:null, scale:2});
      const url = canvas.toDataURL('image/png');
      const a = document.createElement('a'); a.href=url; a.download='birthday-card.png'; a.click();
    });
  </script>
</body>
</html>
